@page
@model JeBalance.Web.Pages.IndexModel

@section styles {
        <!-- Include any specific page styles if necessary -->
}

<div class="container">
    <h1 class="my-4">Génération de JWT Tokens</h1>

    <!-- Button to generate a token with the role Admin -->
    <div>
        <button type="button" class="btn btn-primary mb-3" onclick="generateToken('Admin', 'adminTokenResult')">Récupérer un token avec le rôle Admin</button>
        <div id="adminTokenResult" class="token-result"></div>
    </div>

    <!-- Button to generate a token with the role AdminFiscale -->
    <div>
        <button type="button" class="btn btn-primary mb-3" onclick="generateToken('admin-fiscale', 'adminFiscaleTokenResult')">Récupérer un token avec le rôle AdminFiscale</button>
        <div id="adminFiscaleTokenResult" class="token-result"></div>
    </div>

    <!-- Button to generate a token with both roles Admin and AdminFiscale -->
    <div>
        <button type="button" class="btn btn-primary mb-3" onclick="generateToken('both-admin', 'adminAndAdminFiscaleTokenResult')">Récupérer un token avec les rôles AdminFiscale et Admin</button>
        <div id="adminAndAdminFiscaleTokenResult" class="token-result"></div>
    </div>
</div>

@section scripts {
        <script>
            async function generateToken(roles, resultContainerId) {
                try {
                    const response = await fetch(`/api/app/generate-jwt-token/token-with-${roles}-role`);
                    if (!response.ok) {
                        throw new Error('Error generating token');
                    }

                    const token = await response.text();
                    document.getElementById(resultContainerId).innerText = `Token: ${token}`;
                } catch (error) {
                    console.error('An error occurred:', error.message);
                    document.getElementById(resultContainerId).innerText = 'An error occurred while generating the token.';
                }
            }
        </script>
}
